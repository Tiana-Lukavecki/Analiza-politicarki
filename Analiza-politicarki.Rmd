---
title: "Analiza političarki"
author: "Tiana i Tea"
date: '10 06 2022 '
output: html_document
editor_options: 
  chunk_output_type: console
---

<style>
    pre {
        border: 0;
    }
</style>


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T, message = F, warning = F)
```

```{r libs, include=TRUE, echo=FALSE,message=FALSE, warning=FALSE}
library(tidyverse)
library(readxl)
library(kableExtra)
library(DT)
library(data.table)
library(lubridate)
library(anytime)
library(tidytext)
library(grid)
library(wordcloud)
library(reshape2)
library(ggraph)
library(widyr)
library(topicmodels)
library(ggthemes)
library(report)
library(dplyr)
```

```{r, echo=FALSE}
path <- "C:/Users/Admin/OneDrive/Desktop"
```
# {.tabset}
## Uvod
### Uvod

###### Ovaj projekt bavi se analizom sadržaja aktivnosti na webu povezanih s dvjema političarkama: Sandrom Benčić i Marijom Selak Raspudić. Navedene političarke odabrane su radi izražene aktivnosti na webu, njihove popularnosti i pripadnosti različitim političkim pozicijama (lijevo – desno).  Obrađeni podaci tiču se ukupne aktivnosti povezane s navedenim političarkama na webu u vremenskom razdoblju od 19. veljače 2022. do 30. svibnja 2022., pri čemu će naglasak biti stavljen na deskriptivnu statistiku samih objava te na njihov prikaz po aktivnosti, lajkovima, interakcijama i komentarima.  Uz navedeno, koristit će se analiza sentimenta, odnosno emocionalnog tona korištenih riječi, a kroz grafičke prikaze biti će vidljivo… Cilj ovog projekta je izložiti medijski prikaz dviju političarki te pripadajuću web aktivnost.

## Deskriptivna statistika 
### Broj podataka i broj varijabli

```{r , echo=FALSE}
raw <- list.files(path = path , pattern="xlsx")
raw_path <- paste0(path, "/", raw)
all_raw <- map_df(raw_path, read_excel)

all <- as.data.table(all_raw)
all <- all[,DATE := as.Date(DATE,"%Y-%m-%d")][,DATETIME := anytime(paste(DATE,TIME))]
posts <- all


# some basic data overview
options(digits = 2)
# data size 
dim(posts)
```
##### Prikaz ukupnog broja dobivenih podataka nad kojima je započeta analiza – 2 202, kao i prikaz ukupnog broja uvrštenih varijabli - 49. 

### Vremenski raspon sakupljenih podataka
```{r, echo=FALSE}
# time span
range(posts$DATETIME)
```
##### Obrađeni podaci tiču se vremenskog perioda od 19. veljače 2022. do 30. svibnja 2022.

### Izvor podataka i broj podataka u pojedinim izvorima
```{r, echo=FALSE}
 posts[,.N,SOURCE_TYPE][order(-N)]
```
##### Prikaz svih aktivnosti vezanih uz navedenu temu te njihov broj u navedenim izvorima. Najveća aktivnost primjetna je na webu (1 823 objava), a najmanja na Instagramu (2 objave).

### Broj slova u naslovu
```{r, echo=FALSE}

posts[,
       .(Avg = mean(nchar(TITLE), na.rm = T),
         STD = sd(nchar(TITLE), na.rm = T),
         min = min(nchar(TITLE), na.rm = T),
         max = max(nchar(TITLE), na.rm = T)),
      SOURCE_TYPE][order(-Avg),]
```
##### Navedeni podaci prikazuju različite medije te deskriptivnu statistiku broja slova u naslovu objave (uključuje: prosjek, standardnu devijaciju, minimalnu i maksimalnu vrijednost). Po broju slova prvi je Instagram (prosjek 346), s vrlo malom razlikom između minimalnog i maksimalnog broja slova u naslovu (min – 342, max – 350),  dok su najkraći komentari (prosjek 27). Najveća standardna devijacija pojavljuje se na Redditu (std 218) i Twitteru (std 214), a najmanja na Instagramu (std 5,7).

### Broj slova u tekstu
```{r, echo=FALSE}

posts[,
       .(Avg = mean(nchar(FULL_TEXT)),
         STD = sd(nchar(FULL_TEXT)),
         min = min(nchar(FULL_TEXT)),
         max = max(nchar(FULL_TEXT))),
      SOURCE_TYPE][order(-Avg),]

```
##### Prikaz deskriptivne statistike slova u tekstu u različitim izvorima. Vidljiv je najveći prosjek u dužini teksta na Webu, a najmanji – nepostojeći na Redditu (NA). Najveće odstupanje pojavljuje se na Webu (std 3047), a najmanja ponovno na Redditu. 


```{r leksikoni, echo=FALSE, message=F, warning=F}
# read in lexicons
CroSentilex_n <- read.delim("C:/Users/Admin/OneDrive/Desktop/crosentilex-negatives.txt",
                                   header = FALSE,
                                   sep = " ",
                                   stringsAsFactors = FALSE,
                                   fileEncoding = "UTF-8")  %>%
                   rename(word = "V1", sentiment = "V2" ) %>%
                   mutate(brija = "NEG")
 
CroSentilex_p  <- read.delim("C:/Users/Admin/OneDrive/Desktop/crosentilex-positives.txt",
                                   header = FALSE,
                                   sep = " ",
                                   stringsAsFactors = FALSE,
                                   fileEncoding = "UTF-8") %>%
                    rename(word = "V1", sentiment = "V2" ) %>%
                    mutate(brija = "POZ")
 
Crosentilex_sve <- rbind(setDT(CroSentilex_n), setDT(CroSentilex_p))

#head(sample_n(Crosentilex_sve,1000),15)
 
CroSentilex_Gold  <- read.delim2("C:/Users/Admin/OneDrive/Desktop/crosentilex-gold.txt",
                                 header = FALSE,
                                 sep = " ",
                                 stringsAsFactors = FALSE) %>%
                    rename(word = "V1", sentiment = "V2" ) 
 Encoding(CroSentilex_Gold$word) <- "UTF-8"
 CroSentilex_Gold[1,1] <- "dati"
 CroSentilex_Gold$sentiment <- str_replace(CroSentilex_Gold$sentiment , "-", "1")
 CroSentilex_Gold$sentiment <- str_replace(CroSentilex_Gold$sentiment , "\\+", "2")
 CroSentilex_Gold$sentiment <- as.numeric(unlist(CroSentilex_Gold$sentiment))
# check lexicon data 
#head(sample_n(CroSentilex_Gold,100),15)


 
# create stop words
stopwords_cro <- get_stopwords(language = "hr", source = "stopwords-iso")

# check stopwords data
#head(sample_n(stopwords_cro,100),15)
# extend stop words
my_stop_words <- tibble(
  word = c(
    "jedan","mjera", "može", "mogu", "kad", "sada", "treba", "ima", "osoba",
    "e","prvi", "dva","dvije","drugi",
    "tri","treći","pet","kod",
    "ove","ova",  "ovo","bez", "kod",
    "evo","oko",  "om", "ek",
    "mil","tko","šest", "sedam",
    "osam",   "čim", "zbog",
    "prema", "dok","zato", "koji", 
    "im", "čak","među", "tek",
    "koliko", "tko","kod","poput", 
    "baš", "dakle", "osim", "svih", 
    "svoju", "odnosno", "gdje",
    "kojoj", "ovi", "toga",
     "ubera", "vozača", "hrvatskoj", "usluge", "godine", "više", "taksi", "taxi", "taksija", "taksija", "kaže", "rekao", "19"," aee", "ae"
  ),
  lexicon = "lux"
)
stop_corpus <- my_stop_words %>%
  bind_rows(stopwords_cro)
# check stopwords data
#head(sample_n(stop_corpus,100),15)
```

```{r, echo=FALSE}
raw <- list.files(path = path , pattern="xlsx")
raw_path <- paste0(path, "/", raw)
all_raw <- map_df(raw_path, read_excel)

all <- as.data.table(all_raw)
all <- all[,DATE := as.Date(DATE,"%Y-%m-%d")][,DATETIME := anytime(paste(DATE,TIME))]
posts <- all
```


```{r, echo=FALSE}
web <- posts[SOURCE_TYPE == "web",]
#pofb <- posts[SOURCE_TYPE == "facebook",]
#youtube <- posts[SOURCE_TYPE == "youtube",]
#instagram <- posts[SOURCE_TYPE == "instagram",]
#twitter <- posts[SOURCE_TYPE == "twitter",]
#reddit <- posts[SOURCE_TYPE == "reddit",]
#forum <-  posts[SOURCE_TYPE == "forum",]
#comment <-  posts[SOURCE_TYPE == "comment",]
```

### Portali prema aktivnosti
```{r, eval=T, echo=FALSE}
print(web[,.N,FROM][order(-N)], big.mark=",")
```
##### Prikaz top 5 portala prema aktivnosti na temu Sande Benčić i Marije Selak Raspudić, kao i broj njihovih objava, te zadnjih 5 portala i broj njihovih objava. Na prvom mjestu nalazi se *glasistre.hr* s 87 objava, a odmah iza direktno.hr i hrt.hr. Na zadnjem mjestu nalazi se više portala s jednom objavom – *ntvarena.com, mariborskiodmev.com…*

### Portali prema "dosegu"
```{r, echo=FALSE}
print(unique(web[,REACH := sum(REACH), FROM][FROM != "anonymous_user",.(FROM,REACH)][order(-REACH),]), big.mark=",") 
  
```
##### Prikaz prvih i zadnjih 5 portala prema dosegu ili reachu na navedenu temu, pri čemu je vodeći *indeks.hr*, a zadnje mjesto ponovno dijeli više portala – reach 0 (*hdz.hr, budimpress.ba…*).    

### Portali prema lajkovima
```{r, echo=FALSE}
print(unique(web[,LIKE := sum(LIKE_COUNT), FROM][FROM != "anonymous_user",.(FROM,LIKE)][order(-LIKE),]), big.mark=",")
```
##### Prikaz prvih i zadnjih 5 portala po broju lajkova na navedenu temu. Vodeći portal prema broju lajkova je *indeks.hr* – 10 474, a prate ga *n1info.com* – 8 006, *telegram.hr*, *direktno.hr* i *vecernji.hr*. Bez lajkova na navedenu temu ima više portala, no zadnji u podacima se prikazao *ntvarena.com* – 0 lajkova.

### Portali prema interakcijama
```{r, echo=FALSE}
print(unique(web[,INTERACTIONS := sum(INTERACTIONS), FROM][FROM != "anonymous_user",.(FROM,INTERACTIONS)][order(-INTERACTIONS),]), big.mark=",")
```
##### Prikaz portala na navedenu temu prema broju komentara. Najveći broj komentara – 5 527 zabilježen je na portalu *priznajem.hr*, a bez komentara su portali *ntvarena.com*, *mariboraskiodmev.com*, *cdm.me*.  

### Portali prema komentarima
```{r, echo=FALSE}
print(unique(web[,COMMENT := sum(COMMENT_COUNT), FROM][FROM != "anonymous_user",.(FROM,COMMENT)][order(-COMMENT),]), big.mark=",")
```
##### Prikaz portala na navedenu temu prema broju komentara. Najveći broj komentara – 5 527 zabilježen je na portalu priznajem.hr, a bez komentara su portali *ntvarena.com*, *mariboraskiodmev.com*, *cdm.me*.  

### Broj podataka na webu
```{r, echo=FALSE}
# dim before tokenize
dim(web)
```
##### Prikaz aktivnosti na webu vezano uz Sandru Benčić i Mariju Selak Raspudić te broj varijabli (49). 

### Broj podataka nakon tokenizacije
```{r, echo=FALSE}
# tokenize
web %>% 
  unnest_tokens(word, FULL_TEXT) -> web
# dim after tokenize
dim(web)
# check
#web %>% 
  #
```


### Broj podataka nakon što maknemo "stop" riječi
"Stop" riječi su riječi koje smo izbacili iz analize, a to su najčešće prilozi, prijedlozi, veznici i slično. 
```{r, echo=FALSE}
# remove stop words, numbers, single letters, NA
web %>% 
  anti_join(stop_corpus, by = "word") %>%
  mutate(word = gsub("\\d+", NA, word)) %>%
  mutate(word = gsub("^[a-zA-Z]$", NA, word)) -> web_tokenTidy

web_tokenTidy %>%
  filter(!is.na(word)) -> web_tokenTidy
# check
dim(web_tokenTidy)
web_tokenTidy %>%
  sample_n(.,5) %>%
  datatable(., rownames = FALSE, options = list(pageLength = 5, scrollX=T))
```


### Grafički prikaz frekvencija korištenih riječi u "oblaku riječi"

##### U Oblaku riječi prikazana je učestalost korištenih riječi u portalima, pri čemu se najveće riječi upotrebljavaju najviše puta – u ovom slučaju to su: *posto, HDZ, vlade, Raspudić, Benčić, SDP, Plenković, Selak…*
```{r WCloud,echo=FALSE,message=F, warning=F}
## WordCloud(vulgaris)
web_tokenTidy %>%
  anti_join(CroSentilex_Gold,by="word") %>% 
  count(word) %>% 
  arrange(desc(n)) %>%
  top_n(100) %>%
  with(wordcloud(word, n, max.words = 100)) 
```


## Analiza sentimenta
### Frekvencija sentimenta kroz promatrano vrijeme po tjednima

##### Grafički prikaz sentimenata na navedenu temu u vremenskom periodu od sredine veljače do kraja svibnja. U analizi vrijednost 0 označava neutralno, 1 negativno, a 2 pozitivno. Primjetno je da je kroz veljaču i ožujak sentiment više negativnog tona, dok tijekom travnja prevladava pozitivni sentiment, koji opet postaje negativni tijekom svibnja.

##### **Što se događalo?**
###### Veljača -> uhićenje ministara (Horvat), istrage, afere (Ćorić), „pad“ vlade, traženje novog ministara, početak rata u Ukrajini.
###### Ožujak -> Opoziv ministara, pad drona kod Jaruna, pitanje korištenja novca iz EU fondova, zahtjev za rekonstrukcijom Vlade, Selak Raspudić trudna, pitanje spore obnove.
###### Travanj -> Afere, Možemo pobijedio DORH (tužba radi previše žena na listi), rekonstrukcija Vlade, kritika Milanovića i Plenkovića.
###### Svibanj -> Rasprave o raspuštanju Sabora, rasprava o Zakonu o pobačaju, slučaj Mirele Čavajde, prosvjed.  

```{r sentimentTempus, echo=FALSE,message=F, warning=F}
## Sentiment over time
vizualiziraj_sentiment <- function(dataset, frq = "week") {
dataset %>%
  inner_join( Crosentilex_sve, by = "word") %>%
  filter(!is.na(word)) %>%
  select(word, brija, DATE, sentiment) %>% 
  unique() %>%
  spread(. , brija, sentiment) %>%
  mutate(sentiment = POZ - NEG) %>%
  select(word, DATE, sentiment) %>% 
  group_by(word) %>% 
  mutate(count = n()) %>%
  arrange(desc(count)) %>%
  mutate( score = sentiment*count) %>%
  ungroup() %>%
  group_by(DATE) %>%
  arrange(desc(DATE)) -> sm
 
sm %>%
  select(DATE, score) %>%
  group_by(DATE = floor_date(DATE, frq)) %>%
  summarise(Dnevni_sent = sum(score, na.rm = TRUE)) %>%
  ggplot(., aes(DATE, Dnevni_sent)) +
  geom_bar(stat = "identity") + 
  ggtitle(paste0("Frekvencija sentimenta kroz vrijeme:", frq)) +
  ylab("SentimentScore") +
  theme_economist()-> gg_sentiment_kroz_vrijeme_qv
gg_sentiment_kroz_vrijeme_qv
}
vizualiziraj_sentiment(web_tokenTidy,"week")
```


### Frekvencije riječi po sentimentu
##### Grafički prikaz top 15 najnegativnijih, neutralnih i najpozitivnijih riječi korištenih u objavama i njihova učestalost pojavljivanja. Vidimo da je najveća učestalost korištenja neutralnih riječi (*ministar, vlada, premijer…*), a među negativnim riječima ističu se: *problem, rat, prekid, afera....* Među pozitivnim riječima ističu se: *tim, imati, život, obnova…*
```{r doprinoSentimentu,echo=FALSE,message=F, warning=F, fig.width=10}
## Sentiment 
doprinos_sentimentu <- function(dataset, no = n) {
dataset %>%
  inner_join(CroSentilex_Gold, by = "word") %>% 
  count(word, sentiment,sort = TRUE) %>% 
  group_by(sentiment) %>%
  top_n(no) %>%
  ungroup() %>%
  mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRAL",
                                 sentiment == 1 ~ "NEGATIVE",
                                 sentiment == 2 ~ "POSITIVE")) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word, n, fill = sentiment)) +
  geom_col(show.legend = FALSE) +
  ggtitle( "Sentiment") +
  labs( x = "Riječ", y = "Number of words") +
  facet_wrap(~ sentiment, scales = "free_y") +
  coord_flip() +
  theme_economist() -> gg_doprinos_sentimentu
  
 gg_doprinos_sentimentu
 
}
doprinos_sentimentu(web_tokenTidy,15)
```




### Grafički prikaz frenkvencija korištenih riječi u "oblaku riječi" prema sentimentu
##### Prikaz prethodno navedenih top 15 negativnih, neutralnih i pozitivnih riječi u oblaku.

```{r WCloutSent,echo=FALSE,warning=F, message=F}
## ComparisonCloud
web_tokenTidy %>%
  inner_join(CroSentilex_Gold,by="word") %>% 
  count(word, sentiment) %>% 
  top_n(200) %>%
  mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
                                 sentiment == 1 ~ "-",
                                 sentiment == 2 ~ "+")) %>%
  acast(word ~ sentiment, value.var = "n", fill = 0) %>%
  comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
                   max.words = 120)
```


### Najnegativniji portali
```{r negDomen, echo=FALSE,warning=F, message=F}
## Najnegativniji portali
wCount <- web_tokenTidy %>% 
  group_by(FROM) %>%
  summarise(word = n())
CroSentilex_Gold_neg <- CroSentilex_Gold %>% filter(sentiment == 1)
CroSentilex_Gold_poz <- CroSentilex_Gold %>% filter(sentiment == 2)
web_tokenTidy %>% 
  semi_join(CroSentilex_Gold_neg, by= "word") %>%
  group_by(FROM) %>% 
  summarise(negWords = n()) %>%
  left_join(wCount, by = "FROM") %>%
  mutate(negativnostIndex = (negWords/word)*100) %>%
  arrange(desc(negativnostIndex)) %>%
  print(., big.mark=",")
```
##### Prikaz „najnegativnijih“ portala, odnosno onih koji su koristili najviše negativnih riječi. Vidljivi su portali, broj korištenih negativnih riječi, ukupan broj riječi te indeks negativnosti. Izdvojeno je prvih 10 najnegativnijih portala, gdje prvo mjestu po negativnosti zauzima 360hr.news s korištenih 27 negativnih riječi od njih sveukupno 723 i indexom negativnosti od 3.73. Iza slijede zupanjac.net, mojabih.live, novo.hr…

### Najpozitivniji portali

```{r pozDomen,echo=FALSE, warning=F, message=F}
## Najpozitivniji portali
CroSentilex_Gold_poz <- CroSentilex_Gold %>% filter(sentiment == 2)
web_tokenTidy %>% 
  semi_join(CroSentilex_Gold_poz, by= "word") %>%
  group_by(FROM) %>% 
  summarise(pozWords = n()) %>%
  left_join(wCount, by = "FROM") %>%
  mutate(pozitivnostIndex = (pozWords/word)*100) %>%
  arrange(desc(pozitivnostIndex)) %>%
  print(., big.mark=",") 
```
##### Prikaz „najpozitivnijih“ portala, odnosno onih koji su koristili najviše pozitivnih riječi na navedenu temu. Navedena su imena portala, broj korištenih pozitivnih riječi, ukupan broj riječi i indeks pozitivnosti. Izdvojeno je top 10 najpozitivnijih portala, a na prvom mjestu je dubrovnikinsider.hr s indeksom pozitivnosti 4.74 i 9 pozitivnih riječi, a prate ga 24vesti.com i medjugorje-info.com. 

### Najbitnije riječi u portalima s najvećim "dosegom" 
```{r frekvencija, echo=FALSE, message=F, warning=F, fig.height=10, fig.width=10}
## Udio riječi po domenama
domenaWords <- web_tokenTidy %>%
  filter(FROM %in% c("direktno.hr", "index.hr", "jutarnji.hr" )) %>% 
  count(FROM, word, sort = T)
  
ukupnoWords <- domenaWords %>%
  group_by(FROM) %>%
  summarise(totWords = sum(n))
domenaWords <- left_join(domenaWords, ukupnoWords)
# domenaWords %>% head(15)
# domenaWords %>% 
# ggplot(., aes(n/totWords, fill = domena)) +
#   geom_histogram(show.legend = FALSE) +
#   xlim(NA, 0.0009) +
#   facet_wrap(~domena, ncol = 2, scales = "free_y")
## Najbitnije riječi po domenma
idf <- domenaWords %>%
  bind_tf_idf(word, FROM, n)
idf %>% head(10)
# idf %>% 
#   select(-totWords) %>%
#   arrange(desc(tf_idf))
#idf %>%
#  arrange(desc(tf_idf)) %>%
#  mutate(word = factor(word, levels = rev(unique(word)))) %>% 
#  mutate(FROM = factor(FROM)) %>%
#  group_by(FROM) %>% 
#  top_n(15) %>% 
#  ungroup() %>%
#  ggplot(aes(word, tf_idf, fill = FROM)) +
#  geom_col(show.legend = FALSE) +
#  labs(x = NULL, y = "tf-idf") +
#  facet_wrap(~FROM, ncol = 2, scales = "free") +
#  coord_flip() +
#  theme_economist()
```
##### Prikaz top 10 najvažnijih riječi na temu Sandre Benčić i Marije Selak Raspudić korištenih u portalima s najvećim dosegom. Vidljivi su portali, korištena riječ, koliko je navedena riječ korištena, kao i ukupan broj riječi. Portali koji su pokazali najveći doseg su: indeks.hr, direktno.hr i jutarnnji.hr.  Među njima pokazalo se da su najbitnije korištene riječi bile sljedeće: posto, HDZ, Raspudić, Benčić i Selak.

## Usporedba podataka
### Grafički prikaz korištenja riječi "Benčić" u portalima Direktno.hr, HRT.hr i GlasIstre.hr
```{r, echo=FALSE}
## Articles per domain over time
web_tokenTidy %>% 
   filter(word == "benčić" & FROM %in% c("direktno.hr", "hrt.hr", "glasistre.hr")) %>%
   mutate(WEEK = floor_date(DATE, "week")) %>%
   group_by(WEEK, FROM) %>%
   summarise(n = n()) %>%
   ungroup() %>%
   arrange(desc(n)) %>%
   ggplot(., aes(WEEK,  n)) + 
   geom_line() +
   ggtitle("Korištenje riječi Benčić na portalima") +
   ylab("Broj objava") +
   geom_smooth() +
   facet_wrap(~ FROM, scales = "free_y") +
   theme_economist()
```

### Grafički prikaz korištenja riječi "Možemo" u portalima Direktno.hr, HRT.hr i GlasIstre.hr
```{r, echo=FALSE}
## Articles per domain over time
web_tokenTidy %>% 
   filter(word == "možemo" & FROM %in% c("direktno.hr", "hrt.hr", "glasistre.hr")) %>%
   mutate(WEEK = floor_date(DATE, "week")) %>%
   group_by(WEEK, FROM) %>%
   summarise(n = n()) %>%
   ungroup() %>%
   arrange(desc(n)) %>%
   ggplot(., aes(WEEK,  n)) + 
   geom_line() +
   ggtitle("Korištenje riječi Možemo na portalima") +
   ylab("Broj objava") +
   geom_smooth() +
   facet_wrap(~ FROM, scales = "free_y") +
   theme_economist()
```

### Grafički prikaz korištenja riječi "Selak" u portalima Direktno.hr, HRT.hr i GlasIstre.hr
```{r, echo=FALSE}
## Articles per domain over time
web_tokenTidy %>% 
   filter(word == "selak" & FROM %in% c("direktno.hr", "hrt.hr", "glasistre.hr")) %>%
   mutate(WEEK = floor_date(DATE, "week")) %>%
   group_by(WEEK, FROM) %>%
   summarise(n = n()) %>%
   ungroup() %>%
   arrange(desc(n)) %>%
   ggplot(., aes(WEEK,  n)) + 
   geom_line() +
   ggtitle("Korištenje riječi Selak na portalima") +
   ylab("Broj objava") +
   geom_smooth() +
   facet_wrap(~ FROM, scales = "free_y") +
   theme_economist()
```

### Grafički prikaz korištenja riječi "Most" u portalima Direktno.hr, HRT.hr i GlasIstre.hr
```{r, echo=FALSE}
## Articles per domain over time
web_tokenTidy %>% 
   filter(word == "most" & FROM %in% c("direktno.hr", "hrt.hr", "glasistre.hr")) %>%
   mutate(WEEK = floor_date(DATE, "week")) %>%
   group_by(WEEK, FROM) %>%
   summarise(n = n()) %>%
   ungroup() %>%
   arrange(desc(n)) %>%
   ggplot(., aes(WEEK,  n)) + 
   geom_line() +
   ggtitle("Korištenje riječi Most na portalima") +
   ylab("Broj objava") +
   geom_smooth() +
   facet_wrap(~ FROM, scales = "free_y") +
   theme_economist()
```


